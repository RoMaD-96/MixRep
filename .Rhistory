expression(" "~hat(theta)[r * 3] == 0.44 ~ ", " ~ sigma[r*3] == 0.040)))
)
# Plotting the error bars and points
plot_HPDI_median_rep <- ggplot(HPDI_theta_w_median, aes(x = weight, y = median)) +
geom_errorbar(aes(ymin = lower, ymax = upper, color = replication), width = 0.05, size = 1.4) +
geom_errorbar(data = data_ci_rep, aes(ymin = ymin, ymax = ymax, color = "black"),
width = 0.05, size = 1.4, linetype = 1) +
geom_errorbar(data = data_ci_orig, aes(ymin = ymin, ymax = ymax, color = "firebrick4"),
width = 0.05, size = 1.4, linetype = 1) +
geom_point(data = data_ci_rep, aes(x = weight, y = median), shape = 16, size = 4, color = "black") +
geom_point(data = data_ci_orig, aes(x = weight, y = median), shape = 16, size = 4, color = "firebrick4") +
geom_point(aes(color = replication), shape = 16, size = 4) +
labs(x = "Prior Weight", y = "Effect Size Posterior") +
theme_bw() +
theme(
strip.text.x = element_text(size = 18),
panel.grid.major.x = element_blank(),
legend.position = "none",
legend.title = element_blank(),
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18)
) +
facet_wrap(~ replication, labeller = label_parsed) +
scale_color_manual(values = c("#E69F00", "#009E20", "#0072B2", "black", "firebrick4")) +
scale_x_continuous(breaks = c(-0.15, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0 ,1.15),
labels = c("Rep.", 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, "Orig."))
# Display the plot
print(plot_HPDI_median_rep)
plot_post_fix
# z-value for 95% CI
z_value <- qnorm(0.975)
# Calculate 95% CI for each group
ci_o <- c(to - z_value * so, to + z_value * so)
ci_r1 <- c(tr[1] - z_value * sr[1], tr[1] + z_value * sr[1])
ci_r2 <- c(tr[2] - z_value * sr[2], tr[2] + z_value * sr[2])
ci_r3 <- c(tr[3] - z_value * sr[3], tr[3] + z_value * sr[3])
# Create a data frame
data <- data.frame(
group = c("Original", "Replication 1", "Replication 2", "Replication 3"),
estimate = c(to, tr[1], tr[2], tr[3]),
ymin = c(ci_o[1], ci_r1[1], ci_r2[1], ci_r3[1]),
ymax = c(ci_o[2], ci_r1[2], ci_r2[2], ci_r3[2]),
color = c("#8A0404", "#E69F00", "#009E20", "#0072B2")
)
plot_theta <- ggplot(data) +
geom_point(aes(x = group, y = estimate, color = group), shape = 16, fill = "white", size = 4.5) +
geom_errorbar(aes(x = group, ymin = ymin, ymax = ymax, color = group), width = 0.15, size = 1.8) +
scale_color_manual(values = data$color) +
labs(
y = "Effect Size Estimate",
x = "Study") +
scale_color_manual(
values = c("Original" = "#8A0404" ,"Replication 1" = "#E69F00", "Replication 2" = "#009E20", "Replication 3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[o] == 0.21 ~ ", " ~ sigma[o] == 0.05),
expression(" "~hat(theta)[r*1] == 0.09 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.21 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.44 ~ ", " ~ sigma[r*3] == 0.04))) +
theme_bw() +
theme(
# axis.title.x = element_blank(),
# axis.text.x = element_blank(),
# axis.ticks.x = element_blank(),
panel.grid.major.x = element_blank(),
legend.position = "top",
legend.title = element_blank(),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18)
)
# pdf("ggplot.pdf", pointsize=100, width=20, height=10)
print(plot_theta)
postdens_wrapper$rep_setting <-paste0( "{hat(theta)[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$tr, 2),
"}*',' ~ sigma[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$sr, 2)
)
plot_joint <- ggplot(data = postdens_wrapper, aes(x = theta, y = omega, fill = density)) +
facet_wrap(~ rep_setting, labeller = label_parsed) +
geom_raster(interpolate = TRUE) +
geom_contour(aes(z = density), breaks = seq(0, 24, 3),  alpha = 0.35, size = 0.5) +
scale_fill_continuous_sequential(palette = "Blues 3", rev = TRUE) +
labs(
x = bquote("Effect Size" ~ theta),
y = bquote("Weight Parameter" ~ omega),
fill = "Posterior \n Density"
) +
guides(fill = guide_colorbar(barheight = 20, barwidth = 1.3, title.position = "top")) +
scale_x_continuous(limits=c(-0.10, 0.6), expand = c(0.04, 0.005)) +
scale_y_continuous(limits=c(0, 1), expand = c(0.005, 0.005)) +
theme_bw() +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "right",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title=element_text(size=16),
legend.text = element_text(size = 16),
legend.key.size = unit(10, 'cm'))
print(plot_joint)
plot_weights_m_hpd <- ggplot() +
geom_errorbarh(data = HPDI_weights,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.2) +
geom_line(data=weights_m_post, aes(x=x, y=density, group=rep_number, color=factor(rep_number)),
lty = 1, alpha = 0.9, size = 1.2) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(omega~" Values"),
y = "Density"
) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_weights_m_hpd)
plot_m_theta <- ggplot() +
geom_errorbarh(data = HPDI_theta,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.0) +
geom_errorbarh(data = HPDI_theta_2,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.7, linetype = "22", size = 1.0) +
geom_line(data = theta_m_post_2, aes(x = x, y = density, color = factor(rep_number)),
lty = 22, alpha = 0.5, size = 1.0) +
geom_line(data = theta_m_post, aes(x = x, y = density, color = factor(rep_number)),
alpha = 0.9, size = 1.0) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(theta~" Values"),
y = "Density"
) +
xlim(-0.2, 0.6) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_m_theta)
5+2/2
(5+2)/2
source("~/.cache/.fr-iDA8xo/repmix-main/R/posterior.R")
source("~/.cache/.fr-iDA8xo/repmix-main/R/marglik.R")
r
r
r
library(ggplot2)
library(ggthemes)
library(ggpubr)
library(colorspace)
#   ____________________________________________________________________________
#   Sources                                                                 ####
source("~/.cache/.fr-iDA8xo/repmix-main/R/posterior.R")
source("~/.cache/.fr-iDA8xo/repmix-main/R/marglik.R")
source("Scripts/Using_RepMix/Random_Weights.R")
postdens_wrapper$rep_setting <-paste0( "{hat(theta)[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$tr, 2),
"}*',' ~ sigma[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$sr, 2)
)
plot_joint <- ggplot(data = postdens_wrapper, aes(x = theta, y = omega, fill = density)) +
facet_wrap(~ rep_setting, labeller = label_parsed) +
geom_raster(interpolate = TRUE) +
geom_contour(aes(z = density), breaks = seq(0, 24, 3),  alpha = 0.35, size = 0.5) +
scale_fill_continuous_sequential(palette = "Blues 3", rev = TRUE) +
labs(
x = bquote("Effect Size" ~ theta),
y = bquote("Weight Parameter" ~ omega),
fill = "Posterior \n Density"
) +
guides(fill = guide_colorbar(barheight = 20, barwidth = 1.3, title.position = "top")) +
scale_x_continuous(limits=c(-0.10, 0.6), expand = c(0.04, 0.005)) +
scale_y_continuous(limits=c(0, 1), expand = c(0.005, 0.005)) +
theme_bw() +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "right",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title=element_text(size=16),
legend.text = element_text(size = 16),
legend.key.size = unit(10, 'cm'))
print(plot_joint)
plot_weights_m_hpd <- ggplot() +
geom_errorbarh(data = HPDI_weights,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.2) +
geom_line(data=weights_m_post, aes(x=x, y=density, group=rep_number, color=factor(rep_number)),
lty = 1, alpha = 0.9, size = 1.2) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(omega~" Values"),
y = "Density"
) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_weights_m_hpd)
#   ____________________________________________________________________________
#   Sources                                                                 ####
source("~/.cache/.fr-iDA8xo/repmix-main/R/posterior.R")
source("~/.cache/.fr-iDA8xo/repmix-main/R/marglik.R")
source("Scripts/Using_RepMix/Random_Weights.R")
postdens_wrapper$rep_setting <-paste0( "{hat(theta)[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$tr, 2),
"}*',' ~ sigma[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$sr, 2)
)
plot_joint <- ggplot(data = postdens_wrapper, aes(x = theta, y = omega, fill = density)) +
facet_wrap(~ rep_setting, labeller = label_parsed) +
geom_raster(interpolate = TRUE) +
geom_contour(aes(z = density), breaks = seq(0, 24, 3),  alpha = 0.35, size = 0.5) +
scale_fill_continuous_sequential(palette = "Blues 3", rev = TRUE) +
labs(
x = bquote("Effect Size" ~ theta),
y = bquote("Weight Parameter" ~ omega),
fill = "Posterior \n Density"
) +
guides(fill = guide_colorbar(barheight = 20, barwidth = 1.3, title.position = "top")) +
scale_x_continuous(limits=c(-0.10, 0.6), expand = c(0.04, 0.005)) +
scale_y_continuous(limits=c(0, 1), expand = c(0.005, 0.005)) +
theme_bw() +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "right",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title=element_text(size=16),
legend.text = element_text(size = 16),
legend.key.size = unit(10, 'cm'))
print(plot_joint)
plot_weights_m_hpd <- ggplot() +
geom_errorbarh(data = HPDI_weights,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.2) +
geom_line(data=weights_m_post, aes(x=x, y=density, group=rep_number, color=factor(rep_number)),
lty = 1, alpha = 0.9, size = 1.2) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(omega~" Values"),
y = "Density"
) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_weights_m_hpd)
plot_m_theta <- ggplot() +
geom_errorbarh(data = HPDI_theta,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.0) +
geom_errorbarh(data = HPDI_theta_2,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.7, linetype = "22", size = 1.0) +
geom_line(data = theta_m_post_2, aes(x = x, y = density, color = factor(rep_number)),
lty = 22, alpha = 0.5, size = 1.0) +
geom_line(data = theta_m_post, aes(x = x, y = density, color = factor(rep_number)),
alpha = 0.9, size = 1.0) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(theta~" Values"),
y = "Density"
) +
xlim(-0.2, 0.6) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_m_theta)
library(ggplot2)
library(ggthemes)
library(ggpubr)
library(colorspace)
#   ____________________________________________________________________________
#   Sources                                                                 ####
source("~/.cache/.fr-iDA8xo/repmix-main/R/posterior.R")
source("~/.cache/.fr-iDA8xo/repmix-main/R/marglik.R")
source("Scripts/Using_RepMix/Random_Weights.R")
# z-value for 95% CI
z_value <- qnorm(0.975)
# Calculate 95% CI for each group
ci_o <- c(to - z_value * so, to + z_value * so)
ci_r1 <- c(tr[1] - z_value * sr[1], tr[1] + z_value * sr[1])
ci_r2 <- c(tr[2] - z_value * sr[2], tr[2] + z_value * sr[2])
ci_r3 <- c(tr[3] - z_value * sr[3], tr[3] + z_value * sr[3])
# Create a data frame
data <- data.frame(
group = c("Original", "Replication 1", "Replication 2", "Replication 3"),
estimate = c(to, tr[1], tr[2], tr[3]),
ymin = c(ci_o[1], ci_r1[1], ci_r2[1], ci_r3[1]),
ymax = c(ci_o[2], ci_r1[2], ci_r2[2], ci_r3[2]),
color = c("#8A0404", "#E69F00", "#009E20", "#0072B2")
)
plot_theta <- ggplot(data) +
geom_point(aes(x = group, y = estimate, color = group), shape = 16, fill = "white", size = 4.5) +
geom_errorbar(aes(x = group, ymin = ymin, ymax = ymax, color = group), width = 0.15, size = 1.8) +
scale_color_manual(values = data$color) +
labs(
y = "Effect Size Estimate",
x = "Study") +
scale_color_manual(
values = c("Original" = "#8A0404" ,"Replication 1" = "#E69F00", "Replication 2" = "#009E20", "Replication 3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[o] == 0.21 ~ ", " ~ sigma[o] == 0.05),
expression(" "~hat(theta)[r*1] == 0.09 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.21 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.44 ~ ", " ~ sigma[r*3] == 0.04))) +
theme_bw() +
theme(
# axis.title.x = element_blank(),
# axis.text.x = element_blank(),
# axis.ticks.x = element_blank(),
panel.grid.major.x = element_blank(),
legend.position = "top",
legend.title = element_blank(),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18)
)
# pdf("ggplot.pdf", pointsize=100, width=20, height=10)
print(plot_theta)
postdens_wrapper$rep_setting <-paste0( "{hat(theta)[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$tr, 2),
"}*',' ~ sigma[italic('r')*",
postdens_wrapper$rep_number,
"] == ",
round(postdens_wrapper$sr, 2)
)
plot_joint <- ggplot(data = postdens_wrapper, aes(x = theta, y = omega, fill = density)) +
facet_wrap(~ rep_setting, labeller = label_parsed) +
geom_raster(interpolate = TRUE) +
geom_contour(aes(z = density), breaks = seq(0, 24, 3),  alpha = 0.35, size = 0.5) +
scale_fill_continuous_sequential(palette = "Blues 3", rev = TRUE) +
labs(
x = bquote("Effect Size" ~ theta),
y = bquote("Weight Parameter" ~ omega),
fill = "Posterior \n Density"
) +
guides(fill = guide_colorbar(barheight = 20, barwidth = 1.3, title.position = "top")) +
scale_x_continuous(limits=c(-0.10, 0.6), expand = c(0.04, 0.005)) +
scale_y_continuous(limits=c(0, 1), expand = c(0.005, 0.005)) +
theme_bw() +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "right",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title=element_text(size=16),
legend.text = element_text(size = 16),
legend.key.size = unit(10, 'cm'))
print(plot_joint)
plot_weights_m_hpd <- ggplot() +
geom_errorbarh(data = HPDI_weights,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.2) +
geom_line(data=weights_m_post, aes(x=x, y=density, group=rep_number, color=factor(rep_number)),
lty = 1, alpha = 0.9, size = 1.2) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(omega~" Values"),
y = "Density"
) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_weights_m_hpd)
plot_m_theta <- ggplot() +
geom_errorbarh(data = HPDI_theta,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.8, size = 1.0) +
geom_errorbarh(data = HPDI_theta_2,
aes(xmin = lower, xmax = upper, y = y*1.05, color = factor(rep_number),
height = height), alpha = 0.7, linetype = "22", size = 1.0) +
geom_line(data = theta_m_post_2, aes(x = x, y = density, color = factor(rep_number)),
lty = 22, alpha = 0.5, size = 1.0) +
geom_line(data = theta_m_post, aes(x = x, y = density, color = factor(rep_number)),
alpha = 0.9, size = 1.0) +
scale_color_manual(
values = c("1" = "#E69F00", "2" = "#009E20", "3" = "#0072B2"),
labels = c(expression(" "~hat(theta)[r*1] == 0.090 ~ ", " ~ sigma[r*1] == 0.05),
expression(" "~hat(theta)[r * 2] == 0.210 ~ ", " ~ sigma[r*2] == 0.06),
expression(" "~hat(theta)[r * 3] == 0.440 ~ ", " ~ sigma[r*3] == 0.04))) +
labs(
x = expression(theta~" Values"),
y = "Density"
) +
xlim(-0.2, 0.6) +
theme_bw() +
theme(strip.placement = "outside",   # format to look like title
strip.background = element_blank(),
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title= element_blank(),
legend.text = element_text(size = 16)) +
guides(color=guide_legend(title="Replicated Experiment"))
print(plot_m_theta)
