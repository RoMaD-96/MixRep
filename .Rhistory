theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 20))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 13, height = 8, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 10, height = 6, device='pdf', dpi=500, useDingbats = FALSE)
plot_post_fix
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 20))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 10, height = 6, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 10, height = 6, device='pdf', dpi=500, useDingbats = FALSE)
plot_post_fix
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 20),
legend.title = element_text(size = 20))
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 20),
legend.title = element_text(size = 20))
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 20))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 10, height = 6, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 12, height = 6, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 13, height = 7, device='pdf', dpi=500, useDingbats = FALSE)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 20),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 20),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 13, height = 7, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 13, height = 8, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 12, height = 7, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 15, height = 7, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 15, height = 8, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 15, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 15.5, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
cols <- hcl.colors(n = length(wseq), palette = "Viridis2", alpha = 0.7, rev = TRUE)
cols <- hcl.colors(n = length(wseq), palette = "Sunset", alpha = 0.7, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
plot_post_fix
cols <- hcl.colors(n = length(wseq), palette = "Mako", alpha = 0.7, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
plot_post_fix
cols <- hcl.colors(n = length(wseq), palette = "Plasma", alpha = 0.7, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
plot_post_fix
cols <- hcl.colors(n = length(wseq), palette = "Sunset_Dark", alpha = 0.7, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
plot_post_fix
cols <- hcl.colors(n = length(wseq), palette = "Zissou", alpha = 0.7, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
plot_post_fix
cols <- hcl.colors(n = length(wseq), palette = "viridis", alpha = 0.7, rev = TRUE, start = .8)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
cols <- hcl.colors(n = length(wseq), palette = "viridis", alpha = 0.8, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
cols <- hcl.colors(n = length(wseq), palette = "viridis", alpha = 0.85, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
cols <- hcl.colors(n = length(wseq), palette = "viridis", alpha = 0.9, rev = TRUE)
# Now let's create a data frame for ggplot
densities <- sapply(X = wseq, FUN = function(w) {
rmapPost(theta = thetaseq, tr = tr, sr = sr, to = to, so = so,
null = null, priorsd = priorsd, w = w)
})
# Turn the results into a data frame
df <- data.frame(theta = rep(thetaseq, times = length(wseq)),
density = as.vector(densities),
w = factor(rep(wseq, each = length(thetaseq))))
# Add the additional lines
df$likelihood <- dnorm(x = df$theta, mean = tr, sd = sr)
df$prior_original <- dnorm(x = df$theta, mean = to, sd = so)
df$prior_robust <- dnorm(x = df$theta, mean = null, sd = priorsd)
# Create a separate data frame for the additional lines to help in creating the legend
additional_lines <- data.frame(
theta = rep(thetaseq, 3),
value = c(dnorm(x = thetaseq, mean = tr, sd = sr),
dnorm(x = thetaseq, mean = to, sd = so),
dnorm(x = thetaseq, mean = null, sd = priorsd)),
linetype = factor(rep(c("Likelihood", "Prior Original", "Prior Robust"), each = length(thetaseq)))
)
# The ggplot
plot_post_fix <- ggplot() +
geom_line(data = df, aes(x = theta, y = density, color = w), size = 1) +
geom_line(data = additional_lines, aes(x = theta, y = value, linetype = linetype), size = 0.8) +
scale_color_manual(values = cols) +
scale_linetype_manual(values = c("dashed", "dotted", "dotdash"),
labels = c("Likelihood (Replication)", "Prior (Original component)", "Prior (Robust component)")) +
labs(x = expression("Effect Size" ~ theta), y = "Density") +
theme_bw() +
guides(linetype = guide_legend(title = "Density"),
color = guide_legend(title = "Weight")
)
# To make sure that our additional lines are represented in the legend, we need to add them to the plot
plot_post_fix <- plot_post_fix + geom_line(aes(linetype = "Likelihood (Replication)"), linetype = "dashed", color = "black") +
geom_line(aes(linetype = "Prior (Original component)"), linetype = "dotted", color = "black") +
geom_line(aes(linetype = "Prior (Robust component)"), linetype = "dotdash", color = "black") +
theme(legend.position = "right",
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 22),
legend.text = element_text(size = 18),
legend.title = element_text(size = 19))
ggsave(filename = "plot_post_fix.pdf",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.jpeg",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='pdf', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.jpeg",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, device='diff', dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.jpeg",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, dpi=500, useDingbats = FALSE)
ggsave(filename = "plot_post_fix.jpeg",path = "Plots", plot = plot_post_fix,
width = 16, height = 8.5, dpi=500)
