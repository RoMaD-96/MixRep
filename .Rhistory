axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
ppp_facets <- data.frame(
replication = factor(
c("Replication 1", "Replication 2", "Replication 3", "Replication 4"),
levels = c("Replication 1", "Replication 2", "Replication 3", "Replication 4"),
labels = c(
expression(" " ~ hat(theta)[r * 1] == 0.29 ~ ", " ~ sigma[r * 1] == 0.11),
expression(" " ~ hat(theta)[r * 2] == 0.25 ~ ", " ~ sigma[r * 2] == 0.09),
expression(" " ~ hat(theta)[r * 3] == -0.18 ~ ", " ~ sigma[r * 3] == 0.11),
expression(" " ~ hat(theta)[r * p] == 0.14 ~ ", " ~ sigma[r * p] == 0.06)
)
),
x = -Inf,                  # top-left corner
y =  5,
label = paste0("PPP = ", sprintf("%.3f", ppp_vals))
)
colored_density <- list()
for (i in 1:length(tr)) {
dens_vals <- densities_ppd[[i]]
# Color density where trep > tr
upper_idx <- which(thetaseq >= tr[i])
if (length(upper_idx) > 0) {
colored_density[[i]] <- data.frame(
theta = c(tr[i], thetaseq[upper_idx], max(thetaseq[upper_idx])),
density = c(0, dens_vals[upper_idx], 0),
replication = paste0("Replication ", i)
)
} else {
colored_density[[i]] <- data.frame()
}
}
colored_density_df <- do.call(rbind, colored_density)
# Factor levels
colored_density_df$replication <- factor(
colored_density_df$replication,
levels = c("Replication 1", "Replication 2", "Replication 3", "Replication 4"),
labels = c(
expression(" " ~ hat(theta)[r * 1] == 0.29 ~ ", " ~ sigma[r * 1] == 0.11),
expression(" " ~ hat(theta)[r * 2] == 0.25 ~ ", " ~ sigma[r * 2] == 0.09),
expression(" " ~ hat(theta)[r * 3] == -0.18 ~ ", " ~ sigma[r * 3] == 0.11),
expression(" " ~ hat(theta)[r * p] == 0.14 ~ ", " ~ sigma[r * p] == 0.06)
)
)
# Labels
ppp_labels <- data.frame(
replication = factor(
c("Replication 1", "Replication 2", "Replication 3", "Replication 4"),
levels = c("Replication 1", "Replication 2", "Replication 3", "Replication 4"),
labels = c(
expression(" " ~ hat(theta)[r * 1] == 0.29 ~ ", " ~ sigma[r * 1] == 0.11),
expression(" " ~ hat(theta)[r * 2] == 0.25 ~ ", " ~ sigma[r * 2] == 0.09),
expression(" " ~ hat(theta)[r * 3] == -0.18 ~ ", " ~ sigma[r * 3] == 0.11),
expression(" " ~ hat(theta)[r * p] == 0.14 ~ ", " ~ sigma[r * p] == 0.06)
)
),
x = 0.7,
y = max(sapply(densities_ppd, max)) * 0.9,
label = paste0("p = ", round(c(ppp_1, ppp_2, ppp_3, ppp_4), 3))
)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Replicated effect size" ~ theta["rep"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Replicated effect size" ~ theta["rep"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Replicated effect size" ~ theta["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Replicated effect size" ~ hat^theta["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Replicated effect size" ~ hat(theta)["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
ggsave(
filename = "plot_ppd.pdf", path = "Plots/Mixture_Prior",
plot = plot_ppd_color,
width = 17, height = 7.5, device = "pdf", dpi = 500, useDingbats = FALSE
)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Effect size estimate" ~ hat(theta)["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
ggsave(
filename = "plot_ppd.pdf", path = "Plots/Mixture_Prior",
plot = plot_ppd_color,
width = 17, height = 7.5, device = "pdf", dpi = 500, useDingbats = FALSE
)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect size estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Effect size estimate" ~ hat(theta)["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
plot_ppd_color <- ggplot() +
geom_polygon(
data = colored_density_df,
aes(x = theta, y = density),
fill = "grey40",
alpha = 0.3
) +
geom_text(
data = ppp_facets,
aes(x = x, y = y, label = label),
hjust = -0.1, vjust = 1.1,
size = 5.5,
inherit.aes = FALSE
) +
geom_line(
data = df_densities,
aes(x = theta, y = density),
linewidth = 1
) +
geom_segment(
data = lines_df,
aes(x = x, xend = x, y = 0, yend = yend, color = type, linetype = type),
linewidth = 1
) +
scale_color_manual(
values = c("Observed" = "firebrick2", "Predictive mean" = "black"),
labels = c(
"Observed" = "Observed effect size estimate",
"Predictive mean" = "Predictive mean")
) +
scale_linetype_manual(
values = c("Observed" = "twodash", "Predictive mean" = "dotted"),
labels = c(
"Observed" = "Observed effect size estimate",
"Predictive mean" = "Predictive mean")
) +
facet_wrap(~replication, labeller = label_parsed, ncol = 4) +
labs(
x = expression("Effect size estimate" ~ hat(theta)["r,"]["new"]),
y = "Density",
) +
theme_bw(base_size = 12) +
theme(
strip.text.x = element_text(size = 18),
legend.position = "top",
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 22),
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 22),
legend.title = element_blank(),
legend.text = element_text(size = 16),
plot.caption = element_text(size = 10, hjust = 0.5)
)
print(plot_ppd_color)
ggsave(
filename = "plot_ppd.pdf", path = "Plots/Mixture_Prior",
plot = plot_ppd_color,
width = 17, height = 7.5, device = "pdf", dpi = 500, useDingbats = FALSE
)
